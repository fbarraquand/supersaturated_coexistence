# [Re] Supersaturated coexistance
## 2022 Replication of Huisman & Weissing 1999

This project is the replication of ''Biodiversity of plankton by species oscullations and chaos'' by Jeff Huisman and Franz J. Weeissing.
Full reference to the original article : 
> Huisman, J., Weissing, F. Biodiversity of plankton by species oscillations and chaos. Nature 402, 407–410 (1999). https://doi.org/10.1038/46540

The goal of this project was to test the reproducibility of the results and figure from Huisman (1999) paper and to try to test the stability of thoses results in the parameter space. 

The replication was succesfull and was submitted to Rescience C. 

### Repository Organisation

The `Article/` subfolder contains the LateX files and co needed to produce de pdf version of the article.

The code needed to reproduce the article is in the `Code/` subfolder.

#### `Code/` Subfolders

The `Code/Matrix_C` and `Code/Matrix_K` subfolders contain parameters files used by the article that were too large to be conveniently included in the code

The `Code/DataHW1999` subfolder contains the data files generated by the reproducing code and used to plot the diferent figures to reproduce.

The `Code/DataExp` subfolder contains the data files generated by the code and used in the experiments.

The `Code/Figures` subfolder contains the figures and .tex files generated by the code.

#### `Code/` .R files

The `Code/FScript_Functions.R` file contains function that are used in the other scripts

The `Code/Script_DataHW1999.R` file generate all of the data needed to plot the different Figures of Huissman et al. article. 

The `Code/Script_Exp.R` file generate all of the data needed to conduct our experiments and generate the tables used in our article. 

The different `Code/Script_Fig_%` use the data generated earlier to draw and save the different Figures used either in the reproduction part or in the experiment part.

### Reproduction

#### Article 

As mentionned before, all of the needed files to generate the .pdf article are in the `Article/` subfolder. Instructions are in the subfolder .README

#### Data and Figures

All of the code as been written with R 4.2.0 

All the scripts expect to have `Code/` as their working directory


The calculation of data use the ode() function from the ''DeSolve'' package. 

You can install it by typing (in the R console) : 

```
install.packages("deSolve")
```

The Figures are plotted using the plotly package for its ability to easily integrate 3D plots into subplots, and the ggplot2 package as it is required by plotly. 


You can install it by typing (in the R console) :
```
install.packages("plotly")
install.packages("ggplot2")
```

Finaly, saving the plotly plots into .pdf of .png files requires the save.image() function. To quote the documentation : 

> Description
> 
> Static image exporting via the kaleido python package. kaleido() imports kaleido into a reticulated Python session and returns a ⁠$transform()⁠ method for converting R plots into static images. save_image() provides a convenience wrapper around kaleido()$transform().

You can install it by typing (in the R console) : 

```
install.packages('reticulate')
reticulate::install_miniconda()
reticulate::conda_install('r-reticulate', 'python-kaleido')
reticulate::conda_install('r-reticulate', 'plotly', channel = 'plotly')
reticulate::use_miniconda('r-reticulate')
```

Some calculations are longer than the other (especially the ones for the experiment and the data for the third Figure). Some of them might can trigger benign warnings.
