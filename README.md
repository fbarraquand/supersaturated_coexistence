# [Re] Supersaturated coexistance
## 2022 Replication of Huisman & Weissing 1999

This project is the replication of ''Biodiversity of plankton by species oscillations and chaos'' by Jeff Huisman and Franz J. Weissing.
Full reference to the original article : 
> Huisman, J., Weissing, F. Biodiversity of plankton by species oscillations and chaos. Nature 402, 407–410 (1999). https://doi.org/10.1038/46540

The goal of this project was to reproduce the results and figures from Huisman & Weissing (1999) paper and to test the stability of those results in the parameter space (these tests are hereafter called 'experiments'). 

The replication was successfull and was submitted to Rescience C. 

### Repository Organisation

The `Article/` subfolder contains the files needed to produce the pdf version of the article.

The code needed to reproduce the article is in the `Code/` subfolder.

#### `Code/` Subfolders

The `Code/Matrix_C` and `Code/Matrix_K` subfolders contain parameter files used by the article that were too large to be conveniently included in the code.

The `Code/DataHW1999` subfolder contains the data files generated by the reproducing code and used to plot the different figures to reproduce.

The `Code/DataExp` subfolder contains the data files generated by the code and used in the experiments.

The `Code/Figures` subfolder contains the figures and .tex files generated by the code.

#### `Code/` .R files

The `Code/FScript_Functions.R` file contains functions that are used in the other scripts.

The `Code/Script_DataHW1999.R` file generates all of the data needed to plot the different Figures of the original article. 

The `Code/Script_Exp.R` file generates all of the data needed to conduct our experiments and generates the tables used in our article. 

The different `Code/Script_Fig_%` use the data generated earlier to draw and save the different Figures used either in the reproduction part or in the experiment part.

### Reproduction

#### Article 

As mentioned before, all of the needed files to generate the .pdf article are in the `Article/` subfolder. Instructions are in the subfolder .README.

#### Data and Figures

All of the code has been run with R 4.2.0.

All scripts should be launched from the `Code/` directory.

The calculation of data use thes ode() function from the ''DeSolve'' package in its 1.32 verion.

You can install it by typing (in the R console): 

```
install.packages("deSolve")
```

The Figures are plotted using the plotly package for its ability to easily integrate 3D plots into subplots in its 4.10-0 version, and the ggplot2 package for the very points-heavy Figures in its 3.3.6 version, as well as the patchwork package to create ggplot2 subplots in its 1.1.1 version.


You can install it by typing (in the R console):
```
install.packages("plotly")
install.packages("ggplot2")
install.packages("patchwork")
```

For the experiments, the random parameters were picked following a truncated normal law, provided by the truncnorm package in its 1.0-8 version.

You can install it by typing (in the R console): 
(Notice that it requires the devtools library to install from github)
```
library("devtools")
install_github("olafmersmann/truncnorm")
```

Finally, saving the plotly plots into .pdf of .png files requires the save.image() function. To quote the documentation: 

> Description
> 
> Static image exporting via the kaleido python package. kaleido() imports kaleido into a reticulated Python session and returns a ⁠$transform()⁠ method for converting R plots into static images. save_image() provides a convenience wrapper around kaleido()$transform().

You can install it by typing (in the R console): 

```
install.packages('reticulate')
reticulate::install_miniconda()
reticulate::conda_install('r-reticulate', 'python-kaleido')
reticulate::conda_install('r-reticulate', 'plotly', channel = 'plotly')
reticulate::use_miniconda('r-reticulate')
```

Some calculations are longer than the others (especially the ones for the experiment and the data for the third Figure). Some of them can trigger benign warnings.
