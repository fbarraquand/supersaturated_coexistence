# [Re] Supersaturated coexistence
## 2022 Replication of Huisman & Weissing 1999

This project is the replication of ''Biodiversity of plankton by species oscillations and chaos'' by Jeff Huisman and Franz J. Weissing.

Full reference to the original article : 
> Huisman, J., Weissing, F. Biodiversity of plankton by species oscillations and chaos. Nature 402, 407â€“410 (1999). https://doi.org/10.1038/46540

The goal of this project was to reproduce the results and figures from Huisman & Weissing (1999) and to test the robustness of those results to perturbations of parameters (these additional tests are hereafter called 'numerical experiments'). 

The replication of the original article was successful and was submitted to Rescience C. The additional numerical experiments show, however, that the results are not robust to small perturbations of parameter values. 

### Repository Organisation

The `Article/` subfolder contains the files needed to produce the pdf version of the article.

The code needed to reproduce the article is in the `Code/` subfolder.

#### `Code/` Subfolders

The `Code/Matrix_C` and `Code/Matrix_K` subfolders contain parameter files used by the article that were too large to be conveniently included in the code.

The `Code/DataHW1999` subfolder contains the data files generated by the article reproduction code and used to plot the different figures to reproduce.

The `Code/DataExp` subfolder contains the data files generated by the code for the additional numerical experiments.

The `Code/Figures` subfolder contains the figures and .tex files generated by the code.

#### `Code/` .R files

The `Code/FScript_Functions.R` file contains functions that are used in the other scripts.

The `Code/Script_DataHW1999.R` file generates all of the data needed to plot the different Figures of the original article. 

The `Code/Script_Exp.R` file generates all of the data needed to conduct our numerical experiments and generates the tables used in our article. 

The various `Code/Script_Fig_%` use the data generated earlier to draw and save the various Figures used either in the reproduction part or in the additional numerical experiments part.

### Reproduction

#### Article 

As mentioned before, all of the needed files to generate the .pdf article are in the `Article/` subfolder. Instructions are in the subfolder .README.

#### Data and Figures

All of the code has been run with R 4.2.0. All scripts should be launched from the `Code/` directory.

Numerical integration uses the ode() function from the ''DeSolve'' package in its 1.32 version.

You can install required packages in R through

```
install.packages("deSolve")
install.packages("plotly")
install.packages("ggplot2")
install.packages("patchwork")
library("devtools")
install_github("olafmersmann/truncnorm")
```

The Figures are plotted using the `plotly` package for its ability to easily integrate 3D plots into subplots in its 4.10-0 version, and the `ggplot2` package for the rather points-heavy Figures, in its 3.3.6 version. We also use the `patchwork` package to create `ggplot2` subplots, in its 1.1.1 version. Finally, saving the plotly plots into .pdf of .png files requires the `save.image()` function. 

You can install it by typing (in the R console): 

```
install.packages('reticulate')
reticulate::install_miniconda()
reticulate::conda_install('r-reticulate', 'python-kaleido')
reticulate::conda_install('r-reticulate', 'plotly', channel = 'plotly')
reticulate::use_miniconda('r-reticulate')
```

Note that some computations require more time than others, such as those required for the third Figure (bifurcation plots) and the two additional numerical experiments, that run the differential equations for long periods of time and numerous parameter sets. 
